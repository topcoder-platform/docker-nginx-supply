    #||||||||||||||||||||||
    # Server for API V2 
    #||||||||||||||||||||||  
    server {
        listen       8000;
        server_name  api-work.topcoder.com;
        #charset koi8-r;
        error_log   /var/log/nginx/logs/api_error.log  error;
        access_log  /var/log/nginx/logs/api_access.log  main;
        
        #error_page  404              /404.html;

        # redirect server error pages to the static page /50x.html
        #
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
            }


        location /sample {
            proxy_pass http://sample-service.elasticbeanstalk.com/sample;
        }

        location /sample/person {
            proxy_pass http://sample-service.elasticbeanstalk.com/sample/person;
            include includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/work {
                resolver dns01.topcoder.com valid=30s;
                set $work "ap-work-prod.elasticbeanstalk.com";
                proxy_pass http://$work/v3/work; 
                include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/work-files {
                resolver dns01.topcoder.com valid=30s;
                set $work "ap-work-prod.elasticbeanstalk.com";
                proxy_pass http://$work/v3/work-files;
                include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/attachments {
                resolver dns01.topcoder.com valid=30s;
                set $asp "ap-asp-prod.elasticbeanstalk.com";
                proxy_pass http://ap-asp-prod.elasticbeanstalk.com/v3/attachments;
                include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/copilots {
                resolver dns01.topcoder.com valid=30s;
                set $copilot "ap-copilot-prod.elasticbeanstalk.com";
                proxy_pass http://$copilot/copilots;
                include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/messages {
                resolver dns01.topcoder.com valid=30s;
                set $messaging "ap-messaging-prod.elasticbeanstalk.com";
                proxy_pass http://$messaging/v3/messages;
                include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/threads {
                resolver dns01.topcoder.com valid=30s;
                set $messaging "ap-messaging-prod.elasticbeanstalk.com";
                proxy_pass http://$messaging/v3/threads;
                include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/submissions {
                resolver dns01.topcoder.com valid=30s;
                set $submission "ap-submission-prod.elasticbeanstalk.com";
                proxy_pass http://$submission/v3/submissions;
                include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/app-submissions {
                resolver dns01.topcoder.com valid=30s;
                set $asp "ap-asp-prod.elasticbeanstalk.com";
                proxy_pass http://$asp/v3/app-submissions;
                include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/inboxes {
                resolver dns01.topcoder.com valid=30s;
                set $asp "ap-asp-prod.elasticbeanstalk.com";
                proxy_pass http://$asp/v3/inboxes;
                include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/profiles {
                resolver dns01.topcoder.com valid=30s;
                set $asp "ap-asp-prod.elasticbeanstalk.com";
                proxy_pass http://$asp/v3/profiles;
                include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/projects {
                resolver dns01.topcoder.com valid=30s;
                set $asp "ap-asp-prod.elasticbeanstalk.com";
                proxy_pass http://$asp/v3/projects;
                include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/authorizations {
            resolver dns01.topcoder.com valid=30s;
            set $ebsHost "api.topcoder.com";
            proxy_pass http://$ebsHost/v3/authorizations;
            include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/users {
            resolver dns01.topcoder.com valid=30s;
            set $ebsHost "api.topcoder.com";
            proxy_pass http://$ebsHost;
            include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/users/login {
            proxy_pass http://api.topcoder.com;
            include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/files {
            resolver dns01.topcoder.com valid=30s;
            set $ebsHost "api.topcoder.com";
            proxy_pass http://$ebsHost/v3/files;
            include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/roles {
            resolver dns01.topcoder.com valid=30s;
            set $ebsHost "api.topcoder.com";
            proxy_pass http://$ebsHost/v3/roles;
            include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

        location /v3/permissions {
            resolver dns01.topcoder.com valid=30s;
            set $ebsHost "api.topcoder.com";
            proxy_pass http://$ebsHost/v3/permissions;
            include /etc/nginx/includes/api.topcoder.com.v3location.nginx.conf;
        }

}
